import telebot
import openai
import os

# ØªÛ†Ú©Ù†Û•Ú©Ø§Ù† Ù„Û• Environment Variable
BOT_TOKEN = os.getenv("BOT_TOKEN")
OPENAI_KEY = os.getenv("OPENAI_KEY")

bot = telebot.TeleBot(8437384062:AAF1q-tyLa5XGtV_Y2YPTW_vCiVPIL3nYJI)
openai.api_key = OPENAI_KEY


@bot.message_handler(commands=['start'])
def start(message):
    bot.reply_to(
        message,
        "Ø³ÚµØ§Ùˆ ðŸ‘‹ Ù…Ù† Ø¨Û†ØªÛŒ Ø²ÛŒØ±Û•Ú©ÛŒÙ… ðŸ¤–\nÙ‡Û•Ø± Ù¾Ø±Ø³ÛŒØ§Ø±ÛŽÚ©Ù… Ø¨Ú©Û•ØŒ Ø¨Û• Ú©ÙˆØ±Ø¯ÛŒ ÙˆÛ•ÚµØ§Ù…Øª Ø¯Û•Ø¯Û•Ù…Û•ÙˆÛ•."
    )


@bot.message_handler(func=lambda m: True)
def ai_chat(message):
    try:
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=[
                {
                    "role": "system",
                    "content": "You are an AI assistant. Always reply in Kurdish (Sorani). Never use other languages."
                },
                {"role": "user", "content": message.text}
            ]
        )

        reply = response["choices"][0]["message"]["content"]

        bot.reply_to(message, reply)

    except Exception as e:
        bot.reply_to(
            message,
            "Ø¨Ø¨ÙˆØ±Û• ðŸ˜¢ Ú©ÛŽØ´Û•ÛŒÛ•Ú© Ú•ÙˆÙˆÛŒØ¯Ø§. ØªÚ©Ø§ÛŒÛ• Ø¯ÙˆØ¨Ø§Ø±Û• Ù‡Û•ÙˆÚµØ¨Ø¯Û•."
        )


bot.polling()
